.rules:
  rules:
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    - if: $CI_COMMIT_TAG
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH

lint:
  extends:
    - .node-template
    - .rules
  script:
    - pnpm install
    - pnpm lint

typecheck:
  extends:
    - .node-template
    - .rules
  script:
    - pnpm install
    - pnpm typecheck

spelling:
  extends:
    - .node-template
    - .rules
  script:
    - pnpm install
    - pnpm spelling

e2e:
  extends:
    - .node-template
    - .rules
  script:
    - pnpm install --frozen-lockfile
    - pnpm playwright:install
    - pnpm test:e2e
  artifacts:
    when: always
    paths:
      - playwright-report/
    expire_in: 30 days
